<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image" href="/assets/logo0.png" />
    <meta name= "description" content="CVNZ - objectives- tree" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Sue-Zadeh - Master in Applied Computing" />
    <meta name="theme-color" content="#0a6e2c" />
    <title>FieldSafe</title>
    <!--manifest link-->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Bootstrap CSS - with offline fallback -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
          rel="stylesheet"
          onerror="this.remove()">
    
    <!-- Bootstrap Icons - with offline fallback -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" 
          rel="stylesheet"
          onerror="this.remove()"/>
    
    <!-- Google Fonts - with offline fallback -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital@1&display=swap" 
          rel="stylesheet"
          onerror="this.remove()">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300&display=swap" 
          rel="stylesheet"
          onerror="this.remove()">
    
    <!-- Fallback styles for offline mode -->
    <style>
      /* Basic Bootstrap-like styling for offline mode */
      .btn {
        display: inline-block;
        padding: 0.375rem 0.75rem;
        margin-bottom: 0;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: center;
        text-decoration: none;
        vertical-align: middle;
        cursor: pointer;
        border: 1px solid transparent;
        border-radius: 0.375rem;
        background-color: #007bff;
        color: #fff;
      }
      .btn:hover {
        background-color: #0056b3;
      }
      .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
      }
      .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
      }
      .container {
        width: 100%;
        padding-right: 15px;
        padding-left: 15px;
        margin-right: auto;
        margin-left: auto;
      }
      .row {
        display: flex;
        flex-wrap: wrap;
        margin-right: -15px;
        margin-left: -15px;
      }
      .col, .col-md-6, .col-lg-4 {
        position: relative;
        width: 100%;
        padding-right: 15px;
        padding-left: 15px;
      }
      .form-control {
        display: block;
        width: 100%;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        line-height: 1.5;
        color: #495057;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 0.375rem;
      }
      .table {
        width: 100%;
        margin-bottom: 1rem;
        color: #212529;
        border-collapse: collapse;
      }
      .table th, .table td {
        padding: 0.75rem;
        vertical-align: top;
        border-top: 1px solid #dee2e6;
      }
      .alert {
        padding: 0.75rem 1.25rem;
        margin-bottom: 1rem;
        border: 1px solid transparent;
        border-radius: 0.375rem;
      }
      .alert-info {
        color: #0c5460;
        background-color: #d1ecf1;
        border-color: #bee5eb;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- Vite PWA plugin will automatically inject service worker registration -->
    <script>
      // Additional service worker event listeners for better offline experience
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // The Vite PWA plugin will handle registration automatically
          // But we can add extra logic for update notifications
          navigator.serviceWorker.ready.then((registration) => {
            console.log('‚úÖ Service Worker ready');
            
            // Check for updates periodically
            setInterval(() => {
              registration.update();
            }, 60000); // Check every minute
            
            // Listen for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              if (newWorker) {
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    // New service worker is available
                    console.log('üîÑ New version available!');
                    // Auto-reload for now, could show a notification instead
                    setTimeout(() => window.location.reload(), 1000);
                  }
                });
              }
            });
          }).catch((error) => {
            console.error('‚ùå Service Worker ready failed:', error);
          });
        });
        
        // Listen for messages from service worker
        navigator.serviceWorker.addEventListener('message', (event) => {
          if (event.data && event.data.type === 'SKIP_WAITING') {
            window.location.reload();
          }
        });
      } else {
        console.log('‚ö†Ô∏è Service Worker is not supported in this browser');
      }
    </script>

    <!-- Bootstrap JS - with offline fallback -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js" 
            onerror="console.log('Popper.js failed to load - running in offline mode')"></script> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" 
            defer 
            onerror="console.log('Bootstrap JS failed to load - running in offline mode')"></script>
  </body>
</html>
  